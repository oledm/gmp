<ng-form name="vm.engineForm" novalidate>
    <h4 checkmark>Заполните информацию об объекте обследования</h4>

    <div class="form-group">
        <div class="row">
            <div class="col-sm-4"
                 ng-class="{ 'has-error': vm.engineForm.engine.$touched && vm.engineForm.engine.$invalid }"
                >
              <label class="control-label" for="engine">Двигатель</label>
              <select class="form-control" placeholder="Двигатель" required ng-model="vm.report.engine.type" name="engine" id="engine">
                  <option ng-repeat="engine in vm.engine.all">{{engine.name}}</option>
              </select>
              <div class="help-block" role="alert" ng-messages="vm.engineForm.engine.$error" ng-if="vm.engineForm.engine.$touched">
                  <div ng-messages-include="/static/src/assets/messages.html"></div>
              </div>
            </div>

            <div class="col-sm-4"
                 ng-class="{ 'has-error': vm.engineForm.connection.$touched && vm.engineForm.connection.$invalid }"
                >
              <label class="control-label" for="connection">Схема соединения</label>
              <select class="form-control" required ng-model="vm.report.engine.connection"
                  ng-options="connection.id as connection.name for connection in vm.connection_types"
                  name="connection"
                  >
              </select>
              <div class="help-block" role="alert" ng-messages="vm.engineForm.connection.$error" ng-if="vm.engineForm.connection.$touched">
                  <div ng-messages-include="/static/src/assets/messages.html"></div>
              </div>
            </div>

            <div class="col-sm-4"
                 ng-if="!vm.excelDataExist()"
                 ng-class="{ 'has-error': vm.engineForm.location.$touched && vm.engineForm.location.$invalid }"
                >
              <label class="control-label" for="location">Место установки</label>
              <input class="form-control" type="text" id="location" required
                  name="location" ng-maxlength="50" ng-model="vm.report.obj_data.location" />
              <div class="help-block" role="alert" ng-messages="vm.engineForm.location.$error" ng-if="vm.engineForm.location.$touched">
                  <div ng-messages-include="/static/src/assets/messages.html"></div>
              </div>
            </div>
        </div>
    </div>

    <div class="form-group">
        <div class="row">
            <div class="col-sm-4"
                 ng-if="!vm.excelDataExist()"
                 ng-class="{ 'has-error': vm.engineForm.serial_number.$touched && vm.engineForm.serial_number.$invalid }"
                >
              <label class="control-label" for="serial_number">Заводской номер</label>
              <input class="form-control" type="text" id="serial_number" required
                  name="serial_number" ng-maxlength="50" ng-model="vm.report.engine.serial_number" />
              <div class="help-block" role="alert" ng-messages="vm.engineForm.serial_number.$error" ng-if="vm.engineForm.serial_number.$touched">
                  <div ng-messages-include="/static/src/assets/messages.html"></div>
              </div>
            </div>

            <div class="col-sm-4"
                 ng-if="!vm.excelDataExist()"
                 ng-class="{ 'has-error': vm.engineForm.station_number.$touched && vm.engineForm.station_number.$invalid }"
                >
              <label class="control-label" for="station_number">Станционный номер</label>
              <input class="form-control" type="text" id="station_number" required
                  name="station_number" ng-maxlength="50" ng-model="vm.report.engine.station_number" />
              <div class="help-block" role="alert" ng-messages="vm.engineForm.station_number.$error" ng-if="vm.engineForm.station_number.$touched">
                  <div ng-messages-include="/static/src/assets/messages.html"></div>
              </div>
            </div>

            <div class="col-sm-4"  ng-controller="DatepickerController as dc"
                 ng-if="!vm.excelDataExist()"
                 ng-class="{ 'has-error':
                     vm.engineForm.manufactured_at.$touched &&
                     vm.engineForm.manufactured_at.$invalid }"
                >
                  <label class="control-label" for="manufactured_at">Год изготовления</label>
                    <p class="input-group">
                    <input type="text" watcher ng-model="vm.report.engine.manufactured_at" id="manufactured_at" name="manufactured_at" class="form-control" uib-datepicker-popup="yyyy" ng-model-options="{timezone: 'UTC'}" is-open="dc.popup.opened" ng-required="true" datepicker-options="dc.yearOptions" required />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="dc.open()"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                    </p>
                  <div class="help-block" role="alert" ng-messages="vm.engineForm.manufactured_at.$error" ng-if="vm.engineForm.manufactured_at.$touched">
                      <div ng-messages-include="/static/src/assets/messages.html"></div>
                  </div>
            </div>

        </div>
    </div>
    
    <div class="form-group">
        <div class="row">
            <div class="col-sm-4"  ng-controller="DatepickerController as dc"
                 ng-if="!vm.excelDataExist()"
                 ng-class="{ 'has-error':
                     vm.engineForm.started_at.$touched &&
                     vm.engineForm.started_at.$invalid }"
                >
                  <label class="control-label" for="started_at">Год ввода в эксплуатацию</label>
                    <p class="input-group">
                  <input type="text" watcher ng-model="vm.report.engine.started_at" id="started_at" name="started_at" class="form-control" uib-datepicker-popup="yyyy" ng-model-options="{timezone: 'UTC'}" is-open="dc.popup.opened" ng-required="true" datepicker-options="dc.yearOptions" required   />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="dc.open()"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                    </p>
                  <div class="help-block" role="alert" ng-messages="vm.engineForm.started_at.$error" ng-if="vm.engineForm.started_at.$touched">
                      <div ng-messages-include="/static/src/assets/messages.html"></div>
                  </div>
            </div>

            <div class="col-sm-4"  ng-controller="DatepickerController as dc"
                 ng-if="!vm.excelDataExist()"
                 ng-class="{ 'has-error':
                     vm.engineForm.new_date.$touched &&
                     vm.engineForm.new_date.$invalid }"
                >
                  <label class="control-label" for="new_date">Дата продления срока эксплуатации</label>
                    <p class="input-group">
                  <input type="text" watcher ng-model="vm.report.engine.new_date" id="new_date" name="new_date" class="form-control" uib-datepicker-popup="dd MMMM yyyy" ng-model-options="{timezone: 'UTC'}" is-open="dc.popup.opened" ng-required="true" datepicker-options="dc.dateOptions" required   />
                  <span class="input-group-btn">
                    <button type="button" class="btn btn-default" ng-click="dc.open()"><i class="glyphicon glyphicon-calendar"></i></button>
                  </span>
                    </p>
                  <div class="help-block" role="alert" ng-messages="vm.engineForm.new_date.$error" ng-if="vm.engineForm.new_date.$touched">
                      <div ng-messages-include="/static/src/assets/messages.html"></div>
                  </div>
            </div>

        </div>
    </div>

</ng-form>
